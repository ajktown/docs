# Auth Flow

<!-- TOC -->

- [Auth Flow](#auth-flow)
  - [Sign in with Google](#sign-in-with-google)
  - [Authentication and Authorization for any API calls](#authentication-and-authorization-for-any-api-calls)

<!-- /TOC -->

## Sign in with Google


TODO: Not yet done with it.
```plantuml

@startuml

title Continue with Google

participant "End User" as user
participant "FE" as fe
participant "API" as api
database "MongoDB" as db
participant "Google Server" as google

activate user
  user -> user: User wants to continue with Google
  user -> fe: Clicks button `Continue with Google`
  activate fe
    fe -> google: Redirects to Google Sign in page
    activate google
      user <- google: Asks Google ID and Password to continue
      user -> google: Input Google ID and Password
      google -> google: Authenticates (Simplified)
      fe <- google: Redirects to FE with temporary access token
    deactivate google
    fe -> api: Send the temporary access token
    activate api
      api -> google: Authenticate the temporary access token
      activate google
        google -> google: Checks the access token if it is generated by Google
        api <- google: Approves if valid (Send google response payload)
      deactivate google
      api -> api: Trusts google response payload
      api -> db: Gets user information from mdb with google response payload
      activate db
        api <- db: Returns user info
      deactivate db
      api -> api: Generate access token based on UserDomain
      fe <- api: Returns http only secured token with user information
    deactivate api
    fe -> fe: Redirects to the core app page
    user <- fe: Shows successful sign in
  deactivate fe
deactivate user


```

## Authentication and Authorization for any API calls

